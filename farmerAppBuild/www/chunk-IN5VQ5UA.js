import{J as le,K as ae,a as re}from"./chunk-2E2WOBKK.js";import{A as Q,B as X,M as Y,N as ee,O as te,P as ie,R as ne,c as B,d as Z,f as $,ga as oe,p as H,v as U,w as J,x as K}from"./chunk-B7BKEKPT.js";import"./chunk-EKYO6VDW.js";import"./chunk-24IHF5HR.js";import"./chunk-KFDLIPX5.js";import"./chunk-EPJFQAWK.js";import"./chunk-4UA7XWWY.js";import"./chunk-3P4LCZSC.js";import"./chunk-QB2INVK3.js";import"./chunk-T4NRX6V6.js";import"./chunk-R2OJ64UA.js";import"./chunk-RPLHLNGJ.js";import"./chunk-JZD5S6T4.js";import"./chunk-G223UPOJ.js";import"./chunk-ZSV5V4UX.js";import"./chunk-6AR4DOND.js";import"./chunk-67J5UTTO.js";import"./chunk-3QTGG56W.js";import"./chunk-SACCBILY.js";import"./chunk-GYT6Z5WN.js";import{Gb as u,Hb as q,I as m,Ib as R,J as v,Ja as O,Jb as N,Ka as L,Kb as A,Lb as z,M as C,Nb as G,Q as g,Sa as T,Sb as W,T as a,Tb as j,Ub as D,Wa as V,Y as r,Z as o,_,ab as k,ca as b,da as P,ea as c,n as y,p as S,pa as s,ra as F,u as x,v as h,va as I,wa as E,xa as M}from"./chunk-YS7BCJTD.js";import"./chunk-5BIRNKZZ.js";import"./chunk-PN5KWPLT.js";import"./chunk-ZPEM7JC5.js";import"./chunk-AQXWH6LN.js";import"./chunk-XFZJ45JG.js";import"./chunk-QYFRFJTZ.js";import"./chunk-MN6QQCMN.js";import"./chunk-TP642E63.js";import"./chunk-SRRF7I6H.js";import"./chunk-LNJ3S2LQ.js";var me=(()=>{let l=class l{constructor(t){this.http=t,this.apiUrl="http://127.0.0.1:3000"}login(t){return this.http.post(`${this.apiUrl}/InsertLoginCredentials`,t)}registerUser(t){return this.http.post(`${this.apiUrl}/userTableDetails`,t)}};l.\u0275fac=function(i){return new(i||l)(S(V))},l.\u0275prov=y({token:l,factory:l.\u0275fac,providedIn:"root"});let e=l;return e})();function ge(e,l){e&1&&(r(0,"p"),s(1,"Email is required"),o())}function de(e,l){e&1&&(r(0,"p"),s(1,"Enter a valid email"),o())}function ce(e,l){if(e&1&&(r(0,"ion-text",17),g(1,ge,2,0,"p",18)(2,de,2,0,"p",18),o()),e&2){let n,t,i=c(2);m(),a("ngIf",(n=i.loginForm.get("emailOrPhone"))==null||n.errors==null?null:n.errors.required),m(),a("ngIf",(t=i.loginForm.get("emailOrPhone"))==null||t.errors==null?null:t.errors.invalidFormat)}}function ue(e,l){e&1&&(r(0,"p"),s(1,"Password is required"),o())}function _e(e,l){e&1&&(r(0,"p"),s(1,"Minimum 6 characters required"),o())}function fe(e,l){if(e&1&&(r(0,"ion-text",17),g(1,ue,2,0,"p",18)(2,_e,2,0,"p",18),o()),e&2){let n,t,i=c(2);m(),a("ngIf",(n=i.loginForm.get("password"))==null||n.errors==null?null:n.errors.required),m(),a("ngIf",(t=i.loginForm.get("password"))==null||t.errors==null?null:t.errors.minlength)}}function xe(e,l){if(e&1){let n=b();r(0,"form",7),P("ngSubmit",function(){x(n);let i=c();return h(i.onLogin())}),r(1,"ion-list")(2,"ion-item")(3,"ion-label",8),s(4,"Email"),o(),_(5,"ion-input",9),o(),g(6,ce,3,2,"ion-text",10),r(7,"ion-item")(8,"ion-label",8),s(9,"Password"),o(),_(10,"ion-input",11),r(11,"ion-icon",12),P("click",function(){x(n);let i=c();return h(i.toggleLoginPasswordVisibility())}),o()(),g(12,fe,3,2,"ion-text",10),r(13,"div",13)(14,"ion-button",14),s(15,"Login"),o()(),r(16,"div",15)(17,"span"),s(18,"OR"),o()(),r(19,"p",16),s(20,"Forgot Password?"),o()()()}if(e&2){let n,t,i=c();a("formGroup",i.loginForm),m(6),a("ngIf",((n=i.loginForm.get("emailOrPhone"))==null?null:n.invalid)&&((n=i.loginForm.get("emailOrPhone"))==null?null:n.touched)),m(4),a("type",i.showLoginPassword?"text":"password"),m(),a("name",i.showLoginPassword?"eye-off":"eye"),m(),a("ngIf",((t=i.loginForm.get("password"))==null?null:t.invalid)&&((t=i.loginForm.get("password"))==null?null:t.touched)),m(2),a("disabled",i.loginForm.invalid)}}function he(e,l){e&1&&(r(0,"p"),s(1,"Name is required"),o())}function Pe(e,l){if(e&1&&(r(0,"ion-text",17),g(1,he,2,0,"p",18),o()),e&2){let n,t=c(2);m(),a("ngIf",(n=t.registerForm.get("name"))==null||n.errors==null?null:n.errors.required)}}function ve(e,l){e&1&&(r(0,"p"),s(1,"Email or Phone is required"),o())}function we(e,l){e&1&&(r(0,"p"),s(1,"Enter a valid Email or Phone"),o())}function be(e,l){if(e&1&&(r(0,"ion-text",17),g(1,ve,2,0,"p",18)(2,we,2,0,"p",18),o()),e&2){let n,t,i=c(2);m(),a("ngIf",(n=i.registerForm.get("emailOrPhone"))==null||n.errors==null?null:n.errors.required),m(),a("ngIf",(t=i.registerForm.get("emailOrPhone"))==null||t.errors==null?null:t.errors.invalidFormat)}}function ye(e,l){e&1&&(r(0,"p"),s(1,"Password is required"),o())}function Se(e,l){e&1&&(r(0,"p"),s(1,"Minimum 6 characters required"),o())}function Ce(e,l){if(e&1&&(r(0,"ion-text",17),g(1,ye,2,0,"p",18)(2,Se,2,0,"p",18),o()),e&2){let n,t,i=c(2);m(),a("ngIf",(n=i.registerForm.get("password"))==null||n.errors==null?null:n.errors.required),m(),a("ngIf",(t=i.registerForm.get("password"))==null||t.errors==null?null:t.errors.minlength)}}function Fe(e,l){if(e&1&&(r(0,"ion-select-option",24),s(1),o()),e&2){let n=l.$implicit;a("value",n.id),m(),F(" ",n.name," ")}}function Ie(e,l){e&1&&(r(0,"p"),s(1,"Please select a role"),o())}function Ee(e,l){if(e&1&&(r(0,"ion-text",17),g(1,Ie,2,0,"p",18),o()),e&2){let n,t=c(2);m(),a("ngIf",(n=t.registerForm.get("role"))==null||n.errors==null?null:n.errors.required)}}function Me(e,l){if(e&1){let n=b();r(0,"form",7),P("ngSubmit",function(){x(n);let i=c();return h(i.onRegisterSubmit())}),r(1,"ion-list")(2,"ion-item")(3,"ion-label",8),s(4,"Name"),o(),_(5,"ion-input",19),o(),g(6,Pe,2,1,"ion-text",10),r(7,"ion-item")(8,"ion-label",8),s(9,"Email / Phone"),o(),_(10,"ion-input",20),o(),g(11,be,3,2,"ion-text",10),r(12,"ion-item")(13,"ion-label",8),s(14,"Password"),o(),_(15,"ion-input",21),r(16,"ion-icon",12),P("click",function(){x(n);let i=c();return h(i.toggleRegisterPasswordVisibility())}),o()(),g(17,Ce,3,2,"ion-text",10),r(18,"ion-item")(19,"ion-label",8),s(20,"Select Role"),o(),r(21,"ion-select",22),g(22,Fe,2,2,"ion-select-option",23),o()(),g(23,Ee,2,1,"ion-text",10),r(24,"div",13)(25,"ion-button",14),s(26," Register "),o()()()()}if(e&2){let n,t,i,p,d=c();a("formGroup",d.registerForm),m(6),a("ngIf",((n=d.registerForm.get("name"))==null?null:n.invalid)&&((n=d.registerForm.get("name"))==null?null:n.touched)),m(5),a("ngIf",((t=d.registerForm.get("emailOrPhone"))==null?null:t.invalid)&&((t=d.registerForm.get("emailOrPhone"))==null?null:t.touched)),m(4),a("type",d.showRegisterPassword?"text":"password"),m(),a("name",d.showRegisterPassword?"eye-off":"eye"),m(),a("ngIf",((i=d.registerForm.get("password"))==null?null:i.invalid)&&((i=d.registerForm.get("password"))==null?null:i.touched)),m(5),a("ngForOf",d.userRoles),m(),a("ngIf",((p=d.registerForm.get("role"))==null?null:p.invalid)&&((p=d.registerForm.get("role"))==null?null:p.touched)),m(2),a("disabled",d.registerForm.invalid)}}var f=function(e){return e[e.Admin=1]="Admin",e[e.Wholesaler=2]="Wholesaler",e[e.Retailer=3]="Retailer",e}(f||{}),Ge=(()=>{let l=class l{constructor(t,i,p){this.fb=t,this.router=i,this.authService=p,this.authMode="login",this.showLoginPassword=!1,this.showRegisterPassword=!1,this.userRoles=[{id:f.Wholesaler,name:"Wholesaler"},{id:f.Retailer,name:"Retailer"}],re({eye:le,eyeOff:ae}),this.loginForm=this.fb.group({emailOrPhone:["",[u.required,this.emailValidator]],password:["",[u.required,u.minLength(6)]]}),this.registerForm=this.fb.group({name:["",[u.required]],emailOrPhone:["",[u.required,this.emailValidator]],password:["",[u.required,u.minLength(6)]],role:["",[u.required]]})}toggleLoginPasswordVisibility(){this.showLoginPassword=!this.showLoginPassword}toggleRegisterPasswordVisibility(){this.showRegisterPassword=!this.showRegisterPassword}emailValidator(t){let i=t.value;return i?/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/.test(i)?null:{invalidFormat:!0}:{required:!0}}onLogin(){if(this.loginForm.invalid){this.loginForm.markAllAsTouched();return}let t={email:this.loginForm.value.emailOrPhone,password:this.loginForm.value.password};this.authService.login(t).subscribe({next:i=>{switch(i.role_id){case f.Admin:this.router.navigate(["/admin/driver"]);break;case f.Wholesaler:this.router.navigate(["/wholesaler/home"]);break;case f.Retailer:this.router.navigate(["/buyer/buyer-home"]);break;default:console.error("Unknown role");break}},error:i=>{console.error("Login failed:",i)}})}onRegisterSubmit(){if(this.registerForm.invalid){this.registerForm.markAllAsTouched();return}let t=this.registerForm.value,i={name:t.name,mobile_num:t.emailOrPhone,email:t.emailOrPhone.includes("@")?t.emailOrPhone:"",address:"Default Address",pincode:"000000",location:1,state:1,active_status:1,role_id:t.role};this.authService.registerUser(i).subscribe({next:p=>{console.log("Registration successful:",p),this.authMode="login"},error:p=>{console.error("Registration failed:",p)}})}};l.\u0275fac=function(i){return new(i||l)(v(W),v(k),v(me))},l.\u0275cmp=C({type:l,selectors:[["app-login"]],decls:11,vars:3,consts:[[1,"ion-padding"],[1,"login-container"],[1,"app-title"],["mode","ios",3,"ngModelChange","ngModel"],["value","login",1,"btn"],["value","register",1,"btn"],[3,"formGroup","ngSubmit",4,"ngIf"],[3,"ngSubmit","formGroup"],["position","floating"],["formControlName","emailOrPhone","type","email","autocapitalize","none"],["color","danger",4,"ngIf"],["formControlName","password","autocomplete","current-password",3,"type"],["slot","end",1,"password-toggle",2,"cursor","pointer","margin-top","35px",3,"click","name"],[1,"center-button"],["expand","full","type","submit",1,"custom-button",3,"disabled"],[1,"or-divider"],[1,"forgot-password"],["color","danger"],[4,"ngIf"],["formControlName","name"],["formControlName","emailOrPhone","type","text","autocapitalize","none"],["formControlName","password","autocomplete","new-password",3,"type"],["formControlName","role","interface","action-sheet"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(i,p){i&1&&(r(0,"ion-content",0)(1,"div",1)(2,"h1",2),s(3,"Farmer-App"),o(),r(4,"ion-segment",3),M("ngModelChange",function(w){return E(p.authMode,w)||(p.authMode=w),w}),r(5,"ion-segment-button",4),s(6,"Login"),o(),r(7,"ion-segment-button",5),s(8,"Register"),o()(),g(9,xe,21,6,"form",6)(10,Me,27,9,"form",6),o()()),i&2&&(m(4),I("ngModel",p.authMode),m(5),a("ngIf",p.authMode==="login"),m(),a("ngIf",p.authMode==="register"))},dependencies:[T,O,L,j,A,q,R,N,D,z,G,oe,$,H,U,J,K,Q,X,Y,ee,te,ie,ne,B,Z],styles:['ion-content[_ngcontent-%COMP%]{--keyboard-offset: 0 !important;--overflow: hidden}ion-segment-button[_ngcontent-%COMP%]{--background: white !important;--color: black !important;--indicator-color: rgb(134, 175, 139) !important}.login-container[_ngcontent-%COMP%]{width:100%;max-width:380px;text-align:center}.app-title[_ngcontent-%COMP%]{font-family:Franklin Gothic Medium,sans-serif;font-size:38px;color:#88ac8c;margin-top:50px;margin-bottom:50px}ion-item[_ngcontent-%COMP%]{--background: transparent;--inner-padding-end: 10px;--border-color: rgb(139, 167, 141);border-radius:3px;margin:10px 20px}ion-input[_ngcontent-%COMP%]{--padding-start: 10px;font-size:14px}.center-button[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:20vh}.custom-button[_ngcontent-%COMP%]{font-family:Georgia,Times,serif;--background: rgb(136, 172, 140);--color: white;--border-radius: 8px;--box-shadow: 0 4px 6px rgba(0, 0, 0, .1)}.or-divider[_ngcontent-%COMP%]{display:flex;align-items:center;margin:20px 0}.or-divider[_ngcontent-%COMP%]:before, .or-divider[_ngcontent-%COMP%]:after{content:"";flex:1;height:1px;background:#dbdbdb}.or-divider[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin:0 10px;color:#8e8e8e;font-size:12px;font-weight:700}.forgot-password[_ngcontent-%COMP%]{font-size:12px;color:#526854;margin-top:10px}.password-toggle[_ngcontent-%COMP%]{font-size:1.2rem;opacity:.7}.password-toggle[_ngcontent-%COMP%]:hover{opacity:1}ion-select[_ngcontent-%COMP%]{width:100%;max-width:100%;padding:3px 90px}ion-select[_ngcontent-%COMP%]::part(placeholder){color:var(--ion-color-medium)}ion-select-option[_ngcontent-%COMP%]{font-size:16px}.center-button[_ngcontent-%COMP%]{margin-top:24px}.custom-button[_ngcontent-%COMP%]{--border-radius: 8px;margin:0 auto;width:100%}']});let e=l;return e})();export{Ge as LoginPage};
