import{a as tt}from"./chunk-GCOZ3HQX.js";import{U as Y,a as X}from"./chunk-2E2WOBKK.js";import{a as Z}from"./chunk-KJYOEG4X.js";import{A as q,B as A,Q as N,U as W,W as Q,Y as G,ea as J,f as F,fa as K,g as B,ga as U,h as D,i as R,j as z,l as L,p as V,u as $,v as j,x as H}from"./chunk-B7BKEKPT.js";import"./chunk-EKYO6VDW.js";import"./chunk-24IHF5HR.js";import"./chunk-KFDLIPX5.js";import"./chunk-EPJFQAWK.js";import"./chunk-4UA7XWWY.js";import"./chunk-3P4LCZSC.js";import"./chunk-QB2INVK3.js";import"./chunk-T4NRX6V6.js";import"./chunk-R2OJ64UA.js";import"./chunk-RPLHLNGJ.js";import"./chunk-JZD5S6T4.js";import"./chunk-G223UPOJ.js";import"./chunk-ZSV5V4UX.js";import"./chunk-6AR4DOND.js";import"./chunk-67J5UTTO.js";import"./chunk-3QTGG56W.js";import"./chunk-SACCBILY.js";import"./chunk-GYT6Z5WN.js";import{Aa as g,Ca as _,I as a,J as f,Ja as S,Ka as y,M as I,Q as m,Qa as T,Ra as E,Sa as w,T as d,Y as t,Z as i,_ as x,ca as b,da as h,ea as p,pa as o,qa as C,ra as u,sa as k,ta as P,u as v,v as M}from"./chunk-YS7BCJTD.js";import"./chunk-5BIRNKZZ.js";import"./chunk-PN5KWPLT.js";import"./chunk-ZPEM7JC5.js";import"./chunk-AQXWH6LN.js";import"./chunk-XFZJ45JG.js";import"./chunk-QYFRFJTZ.js";import"./chunk-MN6QQCMN.js";import"./chunk-TP642E63.js";import"./chunk-SRRF7I6H.js";import{h as O}from"./chunk-LNJ3S2LQ.js";function et(n,l){n&1&&(t(0,"div",6),x(1,"ion-spinner",7),t(2,"p"),o(3,"Loading market opportunities..."),i()())}function it(n,l){if(n&1){let e=b();t(0,"ion-card",8)(1,"ion-card-content",9),x(2,"ion-icon",10),t(3,"p"),o(4),i(),t(5,"ion-button",11),h("click",function(){v(e);let s=p();return M(s.loadData())}),o(6," Try Again "),i()()()}if(n&2){let e=p();a(4),C(e.error)}}function nt(n,l){if(n&1&&(t(0,"li"),o(1),i()),n&2){let e=l.$implicit;a(),P(" ",e.product_name," \u2013 ",e.quantity,"kg at \u20B9",e.price_of_product,"/kg ")}}function ot(n,l){if(n&1){let e=b();t(0,"ion-item",16)(1,"ion-label")(2,"h2",17),o(3),i(),t(4,"p",18),o(5),g(6,"date"),i(),t(7,"p",19),o(8),g(9,"number"),i(),t(10,"div",20)(11,"strong"),o(12,"Items:"),i(),t(13,"ul"),m(14,nt,2,3,"li",21),i()()(),t(15,"ion-button",22),h("click",function(){let s=v(e).$implicit,c=p(2);return M(c.openOfferModal(s))}),o(16," Offer "),i()()}if(n&2){let e=l.$implicit;a(3),C(e.retailer_name),a(2),k("#",e.order_id," \u2022 ",_(6,5,e.date_of_order,"mediumDate"),""),a(3),u("Total: \u20B9",_(9,8,e.total_order_amount,"1.2-2"),""),a(6),d("ngForOf",e.items)}}function rt(n,l){if(n&1&&(t(0,"ion-item",16)(1,"ion-label")(2,"h2",17),o(3),i(),t(4,"p"),o(5,"Total Quantity: "),t(6,"strong"),o(7),g(8,"number"),i()(),t(9,"p"),o(10,"Total Order Value: "),t(11,"strong"),o(12),g(13,"number"),i()()()()),n&2){let e=l.$implicit;a(3),C(e.retailer_name),a(4),u("",_(8,3,e.total_quantity,"1.0-2")," kg"),a(5),u("\u20B9",_(13,6,e.total_order_value,"1.2-2"),"")}}function at(n,l){if(n&1&&(t(0,"div",12)(1,"ion-card",13)(2,"ion-card-header")(3,"ion-card-title"),o(4,"\u{1F4E6} Recent Bulk Orders"),i()(),t(5,"ion-card-content")(6,"ion-list"),m(7,ot,17,11,"ion-item",14),i()()(),t(8,"ion-card",15)(9,"ion-card-header")(10,"ion-card-title"),o(11),i()(),t(12,"ion-card-content")(13,"ion-list"),m(14,rt,14,9,"ion-item",14),i()()()()),n&2){let e=p();a(7),d("ngForOf",e.bulkOrders),a(4),u("\u{1F3C6} ",e.getTopRetailersTitle(),""),a(3),d("ngForOf",e.topRetailers)}}var xt=(()=>{let l=class l{constructor(r,s,c){this.wholesalerService=r,this.modalCtrl=s,this.toastCtrl=c,this.isLoading=!1,this.error=null,this.bulkOrders=[],this.topRetailers=[],X({listOutline:Y})}ngOnInit(){this.loadData()}loadData(){return O(this,null,function*(){this.isLoading=!0,this.error=null;try{this.wholesalerService.getBulkOrders().subscribe({next:r=>{this.bulkOrders=r},error:r=>{console.error("Failed to load bulk orders:",r),this.error="Failed to load bulk orders. Please try again."}}),this.wholesalerService.getTopRetailers().subscribe({next:r=>{this.topRetailers=r,console.log("Top retailers:",this.topRetailers)},error:r=>{console.error("Failed to load top retailers:",r),this.error="Failed to load top retailers. Please try again."}})}catch(r){console.error("Failed to load data:",r),this.error="Failed to load market opportunities. Please try again."}finally{this.isLoading=!1}})}openOfferModal(r){return O(this,null,function*(){try{let s=yield this.modalCtrl.create({component:tt,componentProps:{order:r},breakpoints:[0,.5,.8],initialBreakpoint:.8});yield s.present();let{data:c}=yield s.onWillDismiss();console.log("Modal dismissed with data:",c),c!=null&&c.success&&(yield(yield this.toastCtrl.create({message:`Offer #${c.offer_id} submitted successfully!`,duration:2e3,color:"success",position:"bottom"})).present())}catch(s){console.error("Error presenting modal:",s)}})}getTopRetailersTitle(){return"Top 5 Retailers by Order Volume"}};l.\u0275fac=function(s){return new(s||l)(f(Z),f(J),f(K))},l.\u0275cmp=I({type:l,selectors:[["app-market-opportunities"]],decls:10,vars:3,consts:[["slot","start"],["color","dark","defaultHref","/wholesaler/home"],[1,"ion-padding"],["class","loading-state ion-text-center",4,"ngIf"],["class","error-card",4,"ngIf"],["class","opportunities-container",4,"ngIf"],[1,"loading-state","ion-text-center"],["name","dots","color","primary"],[1,"error-card"],[1,"ion-text-center"],["name","alert-circle","color","danger","size","large"],["fill","outline","color","danger",3,"click"],[1,"opportunities-container"],[1,"bulk-orders-card"],["class","custom-item",4,"ngFor","ngForOf"],[1,"top-retailers-card"],[1,"custom-item"],[1,"item-title"],[1,"order-id"],[1,"order-value"],[1,"items-list"],[4,"ngFor","ngForOf"],["fill","solid","size","small","color","success","slot","end",3,"click"]],template:function(s,c){s&1&&(t(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),x(3,"ion-back-button",1),i(),t(4,"ion-title"),o(5,"Market Opportunities"),i()()(),t(6,"ion-content",2),m(7,et,4,0,"div",3)(8,it,7,1,"ion-card",4)(9,at,15,3,"div",5),i()),s&2&&(a(7),d("ngIf",c.isLoading),a(),d("ngIf",c.error),a(),d("ngIf",!c.isLoading&&!c.error))},dependencies:[U,F,B,D,R,z,L,V,$,j,H,q,A,N,W,Q,G,w,S,y,E,T],styles:[".loading-state[_ngcontent-%COMP%]{margin-top:40%}.loading-state[_ngcontent-%COMP%]   ion-spinner[_ngcontent-%COMP%]{margin-bottom:10px}.error-card[_ngcontent-%COMP%]{margin-top:40%}.error-card[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:40px;margin-bottom:10px}.opportunities-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}ion-card-title[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:700;color:#222}ion-card-subtitle[_ngcontent-%COMP%]{font-size:.9rem;color:var(--ion-color-medium)}.bulk-orders-card[_ngcontent-%COMP%], .top-retailers-card[_ngcontent-%COMP%]{border-radius:12px;box-shadow:0 4px 16px #0000000d}.custom-item[_ngcontent-%COMP%]{align-items:flex-start;padding-top:12px;padding-bottom:12px}.custom-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{margin-right:10px}.custom-item[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{margin-top:8px}.item-title[_ngcontent-%COMP%]{font-size:1rem;font-weight:600;margin-bottom:2px}.order-id[_ngcontent-%COMP%]{color:var(--ion-color-medium);font-size:.9rem}.order-value[_ngcontent-%COMP%]{font-weight:500;margin-bottom:6px}.items-list[_ngcontent-%COMP%]{font-size:.9rem;color:var(--ion-color-medium)}.items-list[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{padding-left:16px;margin-top:4px;margin-bottom:0}.items-list[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:2px}"]});let n=l;return n})();export{xt as MarketOpportunitiesComponent};
