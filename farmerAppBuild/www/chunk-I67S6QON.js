import{A as Y,B as Z,O as ee,P as te,S as ie,c as q,d as K,f as z,ga as re,p as H,v as W,w as J,x as Q,z as X}from"./chunk-B7BKEKPT.js";import"./chunk-EKYO6VDW.js";import"./chunk-24IHF5HR.js";import"./chunk-KFDLIPX5.js";import"./chunk-EPJFQAWK.js";import"./chunk-4UA7XWWY.js";import"./chunk-3P4LCZSC.js";import"./chunk-QB2INVK3.js";import"./chunk-T4NRX6V6.js";import"./chunk-R2OJ64UA.js";import"./chunk-RPLHLNGJ.js";import"./chunk-JZD5S6T4.js";import"./chunk-G223UPOJ.js";import"./chunk-ZSV5V4UX.js";import"./chunk-6AR4DOND.js";import"./chunk-67J5UTTO.js";import"./chunk-3QTGG56W.js";import"./chunk-SACCBILY.js";import"./chunk-GYT6Z5WN.js";import{D as w,Gb as y,Hb as O,I as n,Ib as D,J as d,Ja as N,Ka as P,Kb as U,Lb as A,M as T,Nb as B,Q as g,Sa as V,Sb as R,T as c,U as C,Ub as G,W as $,Wa as M,Wb as L,X as k,Y as a,Z as o,_ as f,ca as j,da as v,e as _,ea as u,h as p,n as I,p as S,pa as m,qa as h,u as x,v as E,z as F}from"./chunk-YS7BCJTD.js";import"./chunk-5BIRNKZZ.js";import"./chunk-PN5KWPLT.js";import"./chunk-ZPEM7JC5.js";import"./chunk-AQXWH6LN.js";import"./chunk-XFZJ45JG.js";import"./chunk-QYFRFJTZ.js";import"./chunk-MN6QQCMN.js";import"./chunk-TP642E63.js";import"./chunk-SRRF7I6H.js";import"./chunk-LNJ3S2LQ.js";var oe=(()=>{let t=class t{constructor(e){this.http=e,this.apiUrl="http://127.0.0.1:3000"}getCategories(){return this.http.get(`${this.apiUrl}/getCategories`).pipe(p(this.handleError))}getSuperCategories(){return this.http.get(`${this.apiUrl}/getSuperCategories`).pipe(p(this.handleError))}createCategory(e){return this.http.post(`${this.apiUrl}/categoryDetails`,e).pipe(p(this.handleError))}updateCategory(e){return this.http.put(`${this.apiUrl}/categoryUpdate`,e).pipe(p(this.handleError))}deleteCategory(e){return this.http.delete(`${this.apiUrl}/categoryDelete/${e}`).pipe(p(this.handleError))}handleError(e){if(e.error instanceof ErrorEvent)return console.error("An error occurred:",e.error.message),_(()=>new Error("Something went wrong. Please try again later."));{console.error(`Backend returned code ${e.status}, body was: ${e.error}`);let r="Something went wrong. Please try again later.";return e.error&&e.error.message&&(r=e.error.message),_(()=>new Error(r))}}};t.\u0275fac=function(r){return new(r||t)(S(M))},t.\u0275prov=I({token:t,factory:t.\u0275fac,providedIn:"root"});let i=t;return i})();var ce=(i,t)=>t.category_id;function me(i,t){i&1&&(a(0,"p",10),m(1,"Category Name is required (max 255 characters)."),o())}function pe(i,t){if(i&1&&(a(0,"ion-select-option",4),m(1),o()),i&2){let s=t.$implicit;c("value",s.category_id),n(),h(s.category_name)}}function de(i,t){i&1&&(a(0,"p",10),m(1,"Enter a valid number."),o())}function ge(i,t){if(i&1&&(a(0,"ion-item")(1,"ion-label"),m(2),o()()),i&2){let s=t.$implicit;n(2),h(s)}}function ue(i,t){if(i&1&&(a(0,"ion-list",14),g(1,ge,3,1,"ion-item",9),o()),i&2){let s=u().$implicit,e=u();n(),c("ngForOf",e.availableItems[s])}}function fe(i,t){if(i&1){let s=j();a(0,"ion-item-group")(1,"ion-item",11),v("click",function(){let r=x(s).$implicit,l=u();return E(l.toggleCategory(r))}),a(2,"ion-label")(3,"strong"),m(4),o()(),f(5,"ion-icon",12),o(),g(6,ue,2,1,"ion-list",13),o()}if(i&2){let s=t.$implicit,e=u();n(4),h(s),n(),c("name",e.expandedCategories[s]?"chevron-up":"chevron-down"),n(),c("ngIf",e.expandedCategories[s])}}var Fe=(()=>{let t=class t{constructor(e,r,l,b,ne){this.fb=e,this.el=r,this.categoryService=l,this.navCtrl=b,this.destroyRef=ne,this.superCategories=[],this.expandedCategories={},this.availableItems={Vegetables:["Potato","Spinach","Carrot","Cabbage"],Fruits:["Banana","Apple","Mango","Orange"],"Grains & Pulses":["Rice","Wheat","Lentils","Chickpeas"]},this.category=this.fb.group({category_name:["",[y.required,y.maxLength(255)]],super_cat_id:["-1",[y.required]],remarks:[""]}),this.objectKeys(this.availableItems).forEach(ae=>{this.expandedCategories[ae]=!1})}ngOnInit(){let e=this.categoryService.getSuperCategories().subscribe({next:r=>{console.log("Data:",r),this.superCategories=r},error:r=>{console.error("Error:",r)}});this.destroyRef.onDestroy(()=>e.unsubscribe())}isFieldInvalid(e){let r=this.category.get(e);return!!(r&&r.invalid&&(r.dirty||r.touched))}objectKeys(e){return Object.keys(e)}toggleCategory(e){this.expandedCategories[e]=!this.expandedCategories[e]}submitForm(){if(this.category.valid)console.log("Form Submitted:",this.category.value),this.categoryService.createCategory(this.category.value).subscribe({next:e=>{console.log("Data:",e),this.navCtrl.navigateBack("/admin/product",{queryParams:{category_id:e.category_id}})},error:e=>{console.error("Error:",e)}});else{let e=this.el.nativeElement.querySelector(".invalid");e&&e.scrollIntoView({behavior:"smooth"})}}};t.\u0275fac=function(r){return new(r||t)(d(R),d(w),d(oe),d(L),d(F))},t.\u0275cmp=T({type:t,selectors:[["app-category"]],decls:20,vars:8,consts:[[3,"ngSubmit","formGroup"],["label","Variety","labelPlacement","floating","formControlName","category_name"],["class","error",4,"ngIf"],["placeholder","Select Parent Category","label","Food Type","formControlName","super_cat_id"],[3,"value"],["label","Remarks (Optional)","labelPlacement","floating","formControlName","remarks"],[1,"center-button"],[1,"custom-button"],[1,"center-label"],[4,"ngFor","ngForOf"],[1,"error"],["button","",3,"click"],["slot","end",3,"name"],["class","nested-list",4,"ngIf"],[1,"nested-list"]],template:function(r,l){r&1&&(a(0,"ion-content")(1,"form",0),v("ngSubmit",function(){return l.submitForm()}),a(2,"ion-list")(3,"ion-item"),f(4,"ion-input",1),o(),g(5,me,2,0,"p",2),a(6,"ion-item")(7,"ion-select",3),$(8,pe,2,2,"ion-select-option",4,ce),o()(),g(10,de,2,0,"p",2),a(11,"ion-item"),f(12,"ion-textarea",5),o(),a(13,"div",6)(14,"ion-button",7),m(15," SUBMIT "),o()(),a(16,"ion-list")(17,"ion-label",8),m(18,"AVAILABLE ITEMS"),o(),g(19,fe,7,3,"ion-item-group",9),o()()()()),r&2&&(n(),c("formGroup",l.category),n(2),C("invalid",l.isFieldInvalid("category_name")),n(2),c("ngIf",l.isFieldInvalid("category_name")),n(),C("invalid",l.isFieldInvalid("super_cat_id")),n(2),k(l.superCategories),n(2),c("ngIf",l.isFieldInvalid("super_cat_id")),n(9),c("ngForOf",l.objectKeys(l.availableItems)))},dependencies:[re,z,H,W,J,Q,X,Y,Z,ee,te,ie,q,K,V,N,P,G,U,O,D,A,B],styles:[".center-label[_ngcontent-%COMP%]{display:block;text-align:center;font-weight:700;font-size:1rem;padding-bottom:20px}"]});let i=t;return i})();export{Fe as CategoryComponent};
