import{Ba as de,F as oe,H as ie,Ha as ce,L as ae,P as le,a as re,na as se}from"./chunk-JT32FGMS.js";import{a as me}from"./chunk-GY3CZFAN.js";import{$ as Z,A as U,I as K,J as N,L as G,M as q,N as J,T as Q,V as X,X as Y,ba as ee,c as B,d as A,da as te,f as H,fa as ne,g as z,p as j,u as W,v as $}from"./chunk-I3X6JMJK.js";import"./chunk-EKYO6VDW.js";import"./chunk-24IHF5HR.js";import"./chunk-KFDLIPX5.js";import"./chunk-EPJFQAWK.js";import"./chunk-4UA7XWWY.js";import"./chunk-3P4LCZSC.js";import"./chunk-QB2INVK3.js";import"./chunk-T4NRX6V6.js";import"./chunk-R2OJ64UA.js";import"./chunk-RPLHLNGJ.js";import"./chunk-JZD5S6T4.js";import"./chunk-G223UPOJ.js";import"./chunk-ZSV5V4UX.js";import"./chunk-6AR4DOND.js";import"./chunk-67J5UTTO.js";import"./chunk-3QTGG56W.js";import"./chunk-SACCBILY.js";import"./chunk-GYT6Z5WN.js";import{$ as g,G as x,I as s,Ib as F,J as h,Ka as k,Kb as D,La as E,M as w,Q as p,T as c,Ta as R,Ub as L,Z as o,_ as i,bb as V,da as P,ea as _,fa as u,pa as m,qa as I,ra as v,u as b,v as M,va as y,wa as S,xa as T}from"./chunk-MADRYJFV.js";import"./chunk-5BIRNKZZ.js";import"./chunk-PN5KWPLT.js";import"./chunk-ZPEM7JC5.js";import"./chunk-AQXWH6LN.js";import"./chunk-XFZJ45JG.js";import"./chunk-QYFRFJTZ.js";import"./chunk-MN6QQCMN.js";import"./chunk-TP642E63.js";import"./chunk-SRRF7I6H.js";import{h as O}from"./chunk-LNJ3S2LQ.js";function ge(r,a){r&1&&(o(0,"ion-title"),m(1,"My Orders"),i())}function he(r,a){if(r&1){let l=P();o(0,"ion-searchbar",17),T("ngModelChange",function(e){b(l);let t=u();return S(t.searchTerm,e)||(t.searchTerm=e),M(e)}),_("ionInput",function(e){b(l);let t=u();return M(t.handleSearch(e))}),i()}if(r&2){let l=u();y("ngModel",l.searchTerm)}}function _e(r,a){if(r&1&&(o(0,"ion-segment-button",18)(1,"ion-label"),m(2),i()()),r&2){let l=a.$implicit;c("value",l.value),s(2),I(l.name)}}function fe(r,a){if(r&1){let l=P();o(0,"div",19)(1,"div",20)(2,"div",21)(3,"div",22)(4,"span",23),m(5),i()(),o(6,"ion-button",24),g(7,"ion-icon",25),i()(),o(8,"div",26),g(9,"div",27)(10,"div",28),o(11,"div",29)(12,"div",30)(13,"span",23),m(14,"Total Amount"),i(),o(15,"span",31),m(16),i()(),o(17,"ion-button",32),_("click",function(){let e=b(l).$implicit,t=u();return M(t.viewDetails(e))}),m(18," View Details "),g(19,"ion-icon",33),i()()()()()}if(r&2){let l=a.$implicit;s(5),v("Order #",l.id,""),s(4),c("innerHTML",l.items,x),s(7),v("\u20B9",l.total,"")}}function pe(r,a){r&1&&(o(0,"div",34),g(1,"ion-icon",35),o(2,"h2"),m(3,"No Orders Found"),i(),o(4,"p"),m(5,"There are no orders matching your criteria"),i()())}var d=function(r){return r.DATE="date",r.PRICE_HIGH="price_high",r.PRICE_LOW="price_low",r.BULK="bulk",r.PRODUCT="product",r}(d||{}),Se=(()=>{let a=class a{constructor(n,e,t,C,f){this.wholesalerService=n,this.loadingCtrl=e,this.alertCtrl=t,this.modalCtrl=C,this.router=f,this.filterOptions=[{name:"All Orders",value:d.DATE},{name:"Price \u2191",value:d.PRICE_LOW},{name:"Price \u2193",value:d.PRICE_HIGH},{name:"Bulk Orders",value:d.BULK},{name:"By Product",value:d.PRODUCT}],this.selectedFilter=d.DATE,this.searchTerm="",this.isSearchVisible=!1,this.orders=[],this.filteredOrders=[],re({searchOutline:ce,ellipsisVertical:le,menuOutline:se,closeOutline:ae,chevronDownCircleOutline:oe,chevronForwardOutline:ie,receiptOutline:de})}ngOnInit(){this.loadOrders()}toggleSearch(){this.isSearchVisible=!this.isSearchVisible,this.isSearchVisible||(this.searchTerm="",this.filteredOrders=[...this.orders])}handleSearch(n){let e=n.target.value.toLowerCase();if(!e.trim()){this.filteredOrders=[...this.orders];return}this.filteredOrders=this.orders.filter(t=>!!(t.id.toString().includes(e)||t.total.toString().includes(e)||t.items.toLowerCase().includes(e)))}loadOrders(){return O(this,null,function*(){let n=yield this.loadingCtrl.create({message:"Loading orders...",spinner:"circular"});try{yield n.present(),this.wholesalerService.getOrderItemDetails().subscribe({next:e=>{this.orders=e.map(t=>({id:t.order_id,items:this.formatOrderItems(t.order_items),total:t.total_order_amount})),this.filteredOrders=[...this.orders],n.dismiss()},error:e=>O(this,null,function*(){n.dismiss(),yield(yield this.alertCtrl.create({header:"Error",message:"Failed to load orders. Please try again.",buttons:[{text:"OK",role:"cancel"},{text:"Retry",handler:()=>{this.loadOrders()}}]})).present()})})}catch{n.dismiss(),yield(yield this.alertCtrl.create({header:"Error",message:"An unexpected error occurred.",buttons:["OK"]})).present()}})}formatOrderItems(n){return n.map((e,t)=>`Item ${t+1}: ${e.product_name} - ${e.quantity} ${e.unit_name} (Rs. ${e.max_item_price}/${e.unit_name})`).join(";<br>")}handleFilterChange(n){let e=n.detail.value;e&&this.applyFilter(e)}applyFilter(n){switch(this.selectedFilter=n,n){case d.DATE:this.filteredOrders=[...this.orders].sort((e,t)=>t.id-e.id);break;case d.PRICE_HIGH:this.filteredOrders=[...this.orders].sort((e,t)=>t.total-e.total);break;case d.PRICE_LOW:this.filteredOrders=[...this.orders].sort((e,t)=>e.total-t.total);break;case d.BULK:this.filteredOrders=this.orders.filter(e=>e.total>750);break;case d.PRODUCT:this.filteredOrders=this.orders.sort((e,t)=>e.items.localeCompare(t.items));break}}handleRefresh(n){return O(this,null,function*(){try{yield this.loadOrders()}finally{n.target.complete()}})}viewDetails(n){this.router.navigate(["/wholesaler/order-details",n.id])}};a.\u0275fac=function(e){return new(e||a)(h(me),h(ee),h(Z),h(te),h(V))},a.\u0275cmp=w({type:a,selectors:[["app-screen2"]],decls:18,vars:7,consts:[[1,"ion-no-border"],["mode","ios"],["slot","start"],["defaultHref","/wholesaler/home","color","dark"],[4,"ngIf"],["animated","true","placeholder","Search orders...","show-clear-button","always",3,"ngModel","ngModelChange","ionInput",4,"ngIf"],["slot","end"],[3,"click"],["color","dark","slot","icon-only",3,"name"],["mode","ios",1,"filter-toolbar"],["scrollable","",3,"ionChange","value"],[3,"value",4,"ngFor","ngForOf"],["slot","fixed",3,"ionRefresh"],["pullingIcon","chevron-down-circle-outline","pullingText","Pull to refresh","refreshingSpinner","circular","refreshingText","Refreshing..."],[1,"orders-container"],["class","order-wrapper",4,"ngFor","ngForOf"],["class","no-orders",4,"ngIf"],["animated","true","placeholder","Search orders...","show-clear-button","always",3,"ngModelChange","ionInput","ngModel"],[3,"value"],[1,"order-wrapper"],[1,"order-card"],[1,"order-header"],[1,"order-id"],[1,"label"],["fill","clear","size","small"],["slot","icon-only","name","ellipsis-vertical"],[1,"order-content"],[1,"items",3,"innerHTML"],[1,"divider"],[1,"order-footer"],[1,"total"],[1,"amount"],["fill","solid","size","small",1,"custom-button",3,"click"],["name","chevron-forward-outline","slot","end"],[1,"no-orders"],["name","receipt-outline","size","large"]],template:function(e,t){e&1&&(o(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-buttons",2),g(3,"ion-back-button",3),i(),p(4,ge,2,0,"ion-title",4)(5,he,1,1,"ion-searchbar",5),o(6,"ion-buttons",6)(7,"ion-button",7),_("click",function(){return t.toggleSearch()}),g(8,"ion-icon",8),i()()(),o(9,"ion-toolbar",9)(10,"ion-segment",10),_("ionChange",function(f){return t.handleFilterChange(f)}),p(11,_e,3,2,"ion-segment-button",11),i()()(),o(12,"ion-content")(13,"ion-refresher",12),_("ionRefresh",function(f){return t.handleRefresh(f)}),g(14,"ion-refresher-content",13),i(),o(15,"div",14),p(16,fe,20,3,"div",15),i(),p(17,pe,6,0,"div",16),i()),e&2&&(s(4),c("ngIf",!t.isSearchVisible),s(),c("ngIf",t.isSearchVisible),s(3),c("name",t.isSearchVisible?"close-outline":"search-outline"),s(2),c("value",t.selectedFilter),s(),c("ngForOf",t.filterOptions),s(5),c("ngForOf",t.filteredOrders),s(),c("ngIf",t.filteredOrders.length===0))},dependencies:[ne,H,z,j,W,$,U,K,N,G,q,J,Q,X,B,A,Y,R,k,E,L,F,D],styles:["ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]:first-child{--background: radial-gradient(circle, #ffffff 0%, #eef2f3 100%);--border-width: 0}ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]:first-child   ion-title[_ngcontent-%COMP%]{font-weight:700;font-size:1rem;font-family:Georgia,Times,serif}ion-header[_ngcontent-%COMP%]   ion-searchbar[_ngcontent-%COMP%]{padding:0 8px;--border-radius: 20px;--box-shadow: none;--background: #f4f5f8}ion-header[_ngcontent-%COMP%]   .animated-searchbar[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_slideIn .2s ease-in-out}@keyframes _ngcontent-%COMP%_slideIn{0%{transform:translate(100%)}to{transform:translate(0)}}ion-header[_ngcontent-%COMP%]   .filter-toolbar[_ngcontent-%COMP%]{--background: #f8f9fa;padding:0 8px}ion-header[_ngcontent-%COMP%]   .filter-toolbar[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]{--background: transparent}ion-header[_ngcontent-%COMP%]   .filter-toolbar[_ngcontent-%COMP%]   ion-segment[_ngcontent-%COMP%]   ion-segment-button[_ngcontent-%COMP%]{--color: #666666;--indicator-color: rgb(136, 172, 140);min-width:90px;text-transform:none;font-size:14px}.orders-container[_ngcontent-%COMP%]{padding:16px;background:#f8f9fa;min-height:100%}.order-wrapper[_ngcontent-%COMP%]{margin-bottom:16px}.order-card[_ngcontent-%COMP%]{background:#fff;border-radius:16px;overflow:hidden;box-shadow:0 4px 12px #0000000d}.order-card[_ngcontent-%COMP%]   .order-header[_ngcontent-%COMP%]{padding:16px;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid #f0f0f0}.order-card[_ngcontent-%COMP%]   .order-header[_ngcontent-%COMP%]   .order-id[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.order-card[_ngcontent-%COMP%]   .order-header[_ngcontent-%COMP%]   .order-id[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-weight:600;color:#333}.order-card[_ngcontent-%COMP%]   .order-header[_ngcontent-%COMP%]   .order-id[_ngcontent-%COMP%]   ion-chip[_ngcontent-%COMP%]{margin:0;height:24px}.order-card[_ngcontent-%COMP%]   .order-content[_ngcontent-%COMP%]{padding:16px}.order-card[_ngcontent-%COMP%]   .order-content[_ngcontent-%COMP%]   .items[_ngcontent-%COMP%]{color:#666;font-size:.9rem;line-height:1.5}.order-card[_ngcontent-%COMP%]   .order-content[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]{height:1px;background:#f0f0f0;margin:16px 0}.order-card[_ngcontent-%COMP%]   .order-content[_ngcontent-%COMP%]   .order-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.order-card[_ngcontent-%COMP%]   .order-content[_ngcontent-%COMP%]   .order-footer[_ngcontent-%COMP%]   .total[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.order-card[_ngcontent-%COMP%]   .order-content[_ngcontent-%COMP%]   .order-footer[_ngcontent-%COMP%]   .total[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:.8rem;color:#666}.order-card[_ngcontent-%COMP%]   .order-content[_ngcontent-%COMP%]   .order-footer[_ngcontent-%COMP%]   .total[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{font-size:1.1rem;font-weight:700;color:#88ac8c}.order-card[_ngcontent-%COMP%]   .custom-button[_ngcontent-%COMP%]{--background: rgb(136, 172, 140);--background-hover: rgb(116, 152, 120);--background-activated: rgb(116, 152, 120);--background-focused: rgb(116, 152, 120);--color: white;--box-shadow: 0 2px 6px rgba(136, 172, 140, .3);--ripple-color: rgb(116, 152, 120);--border-radius: 6px}@media (prefers-color-scheme: dark){.order-card[_ngcontent-%COMP%]{background:#1e1e1e}.order-card[_ngcontent-%COMP%]   .order-header[_ngcontent-%COMP%]{border-bottom-color:#333}.order-card[_ngcontent-%COMP%]   .order-content[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]{background:#333}}"]});let r=a;return r})();export{Se as OrdersComponent};
