import{R as ue,a as _e,f as fe}from"./chunk-ZSFP4GD7.js";import{a as he}from"./chunk-MLCCNMJ3.js";import{B as ee,C as te,L as ie,P as ne,Q as re,R as oe,U as ae,W as se,Y as le,aa as de,c as R,ca as ce,fa as me,g as Q,ga as pe,h as W,i as H,j as $,k as q,l as G,m as U,p as Y,q as b,u as J,v as K,w as X,y as Z}from"./chunk-BQTIQUN7.js";import"./chunk-EKYO6VDW.js";import"./chunk-24IHF5HR.js";import"./chunk-KFDLIPX5.js";import"./chunk-EPJFQAWK.js";import"./chunk-4UA7XWWY.js";import"./chunk-3P4LCZSC.js";import"./chunk-QB2INVK3.js";import"./chunk-T4NRX6V6.js";import"./chunk-R2OJ64UA.js";import"./chunk-RPLHLNGJ.js";import"./chunk-JZD5S6T4.js";import"./chunk-G223UPOJ.js";import"./chunk-ZSV5V4UX.js";import"./chunk-6AR4DOND.js";import"./chunk-67J5UTTO.js";import"./chunk-3QTGG56W.js";import"./chunk-SACCBILY.js";import"./chunk-GYT6Z5WN.js";import{$ as g,I as l,J as f,Ka as D,Kb as V,La as A,M as I,Mb as z,Q as u,T as d,Ta as L,Wb as N,Z as o,Zb as j,_ as a,da as y,db as B,ea as C,fa as h,ja as v,ka as E,la as F,pa as c,qa as P,ra as O,sa as S,u as w,v as x,va as T,wa as k,xa as M}from"./chunk-SSO4CHWC.js";import"./chunk-5BIRNKZZ.js";import"./chunk-PN5KWPLT.js";import"./chunk-ZPEM7JC5.js";import"./chunk-AQXWH6LN.js";import"./chunk-XFZJ45JG.js";import"./chunk-QYFRFJTZ.js";import"./chunk-MN6QQCMN.js";import"./chunk-TP642E63.js";import"./chunk-SRRF7I6H.js";import{h as p}from"./chunk-LNJ3S2LQ.js";function Ce(n,s){if(n&1&&(o(0,"ion-select-option",10),c(1),a()),n&2){let r=s.$implicit;d("value",r),l(),O(" ",r," ")}}function Oe(n,s){if(n&1){let r=y();o(0,"ion-button",11),C("click",function(){w(r);let e=h();return x(e.applyFilter("All Orders"))}),g(1,"ion-icon",12),a()}}function we(n,s){n&1&&(o(0,"ion-row")(1,"ion-col",13),g(2,"ion-spinner",14),o(3,"p"),c(4,"Loading orders..."),a()()())}function xe(n,s){if(n&1){let r=y();o(0,"ion-row")(1,"ion-col",13),g(2,"ion-icon",15),o(3,"p"),c(4,"Failed to load orders"),a(),o(5,"ion-button",16),C("click",function(){w(r);let e=h();return x(e.loadCompletedOrders())}),c(6," Try Again "),a()()()}}function ye(n,s){n&1&&(o(0,"ion-col",20)(1,"p"),c(2,"No completed orders found"),a()())}function be(n,s){if(n&1&&(o(0,"ion-item")(1,"ion-label")(2,"h3"),c(3),a(),o(4,"p"),c(5),a(),o(6,"p"),c(7),a()()()),n&2){let r=s.$implicit;l(3),P(r.product_name),l(2),S("Quantity: ",r.quantity," ",r.unit_name,""),l(2),O("Max Price: \u20B9",r.max_item_price,"")}}function Ie(n,s){if(n&1&&(o(0,"ion-card-content")(1,"ion-list"),u(2,be,8,4,"ion-item",22),a()()),n&2){let r=h().$implicit;l(2),d("ngForOf",r.order_items)}}function ve(n,s){if(n&1){let r=y();o(0,"ion-col",17)(1,"ion-card",21),C("click",function(){let e=w(r).$implicit,t=h(2);return x(t.viewOrderDetails(e))}),o(2,"ion-card-header")(3,"ion-card-title"),c(4),a(),o(5,"ion-card-subtitle"),c(6),a()(),u(7,Ie,3,1,"ion-card-content",9),a()()}if(n&2){let r=s.$implicit,i=h(2);l(4),O("Order #",r.order_id,""),l(2),O("Total: \u20B9",r.total_order_amount,""),l(),d("ngIf",i.selectedOrderId===r.order_id)}}function Ee(n,s){if(n&1&&(o(0,"ion-row")(1,"ion-col",17)(2,"ion-grid")(3,"ion-row"),u(4,ye,3,0,"ion-col",18)(5,ve,8,3,"ion-col",19),a()()()()),n&2){let r=h();l(4),d("ngIf",r.completedOrders.length===0),l(),d("ngForOf",r.completedOrders)("ngForTrackBy",r.trackById)}}var ze=(()=>{let s=class s{constructor(i,e,t,m,_,ge){this.router=i,this.navCtrl=e,this.wholesalerApiService=t,this.loadingCtrl=m,this.toastCtrl=_,this.alertCtrl=ge,this.completedOrders=[],this.filters=["All Orders","1 day ago","2 days ago","3 days ago","4 days ago","Custom search"],this.selectedFilter=null,this.selectedOrderId=null,this.isLoading=!1,this.hasError=!1,this.originalOrders=[],this.customStartDate="",this.customEndDate="",this.notifications=5,this.messages=3,_e({alertCircleOutline:fe,closeCircleOutline:ue}),this.loadCompletedOrders()}ngAfterViewInit(){this.content.scrollEvents=!0}loadCompletedOrders(i){return p(this,null,function*(){let e=yield this.loadingCtrl.create({message:"Loading orders...",spinner:"circular"});try{yield e.present(),this.isLoading=!0,this.hasError=!1,this.wholesalerApiService.getCompletedOrders(i).subscribe({next:t=>p(this,null,function*(){this.originalOrders=t,this.completedOrders=t,yield e.dismiss(),this.isLoading=!1,t.length===0&&this.showToast("No completed orders found")}),error:t=>p(this,null,function*(){console.error("Error loading completed orders:",t),yield e.dismiss(),this.isLoading=!1,this.hasError=!0,this.showError("Failed to load orders",t.message)})})}catch{yield e.dismiss(),this.isLoading=!1,this.hasError=!0,this.showError("Unexpected error","Please try again later")}})}showToast(i){return p(this,null,function*(){yield(yield this.toastCtrl.create({message:i,duration:2e3,position:"bottom",color:"medium"})).present()})}showError(i,e){return p(this,null,function*(){yield(yield this.alertCtrl.create({header:i,message:e,buttons:[{text:"Dismiss",role:"cancel"},{text:"Retry",handler:()=>{this.loadCompletedOrders()}}]})).present()})}applyFilter(i){return p(this,null,function*(){if(!i||i==="All Orders"){this.selectedFilter="All Orders",this.completedOrders=this.originalOrders;return}switch(i){case"1 day ago":yield this.loadCompletedOrders(1);break;case"2 days ago":yield this.loadCompletedOrders(2);break;case"3 days ago":yield this.loadCompletedOrders(3);break;case"4 days ago":yield this.loadCompletedOrders(4);break;case"Custom search":yield this.showCustomDateFilter();break;default:this.completedOrders=this.originalOrders}})}showCustomDateFilter(){return p(this,null,function*(){yield(yield this.alertCtrl.create({header:"Custom Date Range",inputs:[{name:"startDate",type:"date",label:"Start Date"},{name:"endDate",type:"date",label:"End Date"}],buttons:[{text:"Cancel",role:"cancel",handler:()=>{this.selectedFilter="All Orders",this.completedOrders=this.originalOrders}},{text:"Filter",handler:e=>!e.startDate||!e.endDate?(this.selectedFilter="All Orders",!1):(this.filterByDateRange(new Date(e.startDate),new Date(e.endDate)),!0)}]})).present()})}filterByDateRange(i,e){if(!i||!e){this.showToast("Please select both start and end dates"),this.selectedFilter="All Orders",this.completedOrders=this.originalOrders;return}this.completedOrders=this.originalOrders.filter(t=>{let m=new Date(t.created_at||"");return m>=i&&m<=e}),this.completedOrders.length===0&&this.showToast("No orders found in selected date range")}viewOrderDetails(i){this.selectedOrderId=this.selectedOrderId===i.order_id?null:i.order_id}trackById(i,e){return e.order_id}};s.\u0275fac=function(e){return new(e||s)(f(B),f(j),f(he),f(ce),f(me),f(de))},s.\u0275cmp=I({type:s,selectors:[["app-past-orders"]],viewQuery:function(e,t){if(e&1&&v(b,5),e&2){let m;E(m=F())&&(t.content=m.first)}},decls:18,vars:8,consts:[["mode","ios"],["slot","start"],["defaultHref","/wholesaler/home","color","dark"],[1,"ion-text-center","custom-title"],[3,"scrollEvents"],["size","12",1,"filters"],[3,"ngModelChange","ionChange","ngModel","disabled"],[3,"value",4,"ngFor","ngForOf"],["fill","clear","slot","end",3,"click",4,"ngIf"],[4,"ngIf"],[3,"value"],["fill","clear","slot","end",3,"click"],["name","close-circle-outline"],[1,"ion-text-center"],["name","circular"],["name","alert-circle-outline","color","danger","size","large"],["fill","clear",3,"click"],["size","12"],["size","12","class","ion-text-center",4,"ngIf"],["size","12",4,"ngFor","ngForOf","ngForTrackBy"],["size","12",1,"ion-text-center"],[3,"click"],[4,"ngFor","ngForOf"]],template:function(e,t){e&1&&(o(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),g(3,"ion-back-button",2),a(),o(4,"ion-title",3),c(5,"Orders Completed"),a()()(),o(6,"ion-content",4)(7,"ion-row")(8,"ion-col",5)(9,"ion-item")(10,"ion-label"),c(11,"Filter Orders"),a(),o(12,"ion-select",6),M("ngModelChange",function(_){return k(t.selectedFilter,_)||(t.selectedFilter=_),_}),C("ionChange",function(_){return t.applyFilter(_.detail.value)}),u(13,Ce,2,2,"ion-select-option",7),a(),u(14,Oe,2,0,"ion-button",8),a()()(),u(15,we,5,0,"ion-row",9)(16,xe,7,0,"ion-row",9)(17,Ee,6,3,"ion-row",9),a()),e&2&&(l(6),d("scrollEvents",!0),l(6),T("ngModel",t.selectedFilter),d("disabled",t.isLoading),l(),d("ngForOf",t.filters),l(),d("ngIf",t.selectedFilter&&t.selectedFilter!=="All Orders"),l(),d("ngIf",t.isLoading),l(),d("ngIf",t.hasError),l(),d("ngIf",!t.isLoading&&!t.hasError))},dependencies:[pe,Q,W,H,$,q,G,U,Y,b,J,K,X,Z,ee,te,ie,ne,re,oe,ae,se,R,le,L,D,A,N,V,z],styles:['ion-toolbar[_ngcontent-%COMP%]:first-child{--background: radial-gradient(circle, #ffffff 0%, #eef2f3 100%);--border-width: 0}ion-title[_ngcontent-%COMP%]{font-weight:700;font-size:1rem;font-family:Georgia,Times,serif}.custom-badge[_ngcontent-%COMP%]{--background: rgb(150, 235, 85);--color: white}ion-button[_ngcontent-%COMP%]{--color: rgb(245, 240, 230)}.filters[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-bottom:15px}ion-item[_ngcontent-%COMP%]{width:100%}ion-card[_ngcontent-%COMP%]{background:radial-gradient(circle,#fff,#eef2f3);text-align:center;text-transform:uppercase;font-family:Poppins,sans-serif;transition:transform .3s ease-in-out,box-shadow .3s ease-in-out;border-radius:12px;overflow:hidden;box-shadow:0 4px 8px #0000001a}ion-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 6px 12px #00000026}ion-card[_ngcontent-%COMP%]:hover:before{content:"";position:absolute;top:-10px;left:-10px;right:-10px;bottom:-10px;background:#007bff1a;filter:blur(15px);z-index:-1;border-radius:16px}ion-card-title[_ngcontent-%COMP%]{font-size:1.5rem}.fixed-button[_ngcontent-%COMP%]{position:fixed;bottom:20px;left:20px;z-index:1000;transition:transform .3s ease-in-out}.fixed-button[_ngcontent-%COMP%]:hover{transform:rotate(360deg)}']});let n=s;return n})();export{ze as PastOrdersComponent};
